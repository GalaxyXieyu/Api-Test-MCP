testcase:
  name: device_bind_washing
  description: 新增xxx
  allure:
    epic: B端APP
    feature: 设备管理
    story: 新增xxx

  steps:
    - id: spu_deviceType
      description: 获取设备类型
      project:
      path: /spu/deviceType
      method: GET
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        imei: '865403061390000'
        authorizationClientType: 3
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success

    - id: shop_shopSelectList_v2
      description: 店铺选择列表
      project:
      path: /shop/shopSelectList
      method: POST
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        authorizationClientType: 3
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success
        - type: is not None
          field: data[1].id

    - id: spu_list_split
      description: 型号列表
      project:
      path: /spu/list/split
      method: GET
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        authorizationClientType: 3
        categoryId: 10
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success
        - type: is not None
          field: data

    - id: position_getDetail
      description: 获取点位详情
      project:
      path: /position/getDetail
      method: GET
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        authorizationClientType: 3
        id: 00001
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success
        - type: equal
          field: data.id
          expected: 33553

    - id: spu_sku
      description: sku列表
      project:
      path: /spu/sku
      method: POST
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        spuId: '01'
        priceCalculateMode: 2
        priceType: 1
        shopId: '0000977'
        authorizationClientType: '3'
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success

    - id: device_bind
      description: 新增xxx
      project: merchant
      path: '/device/bind?platform=Android'
      method: POST
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        deviceModelNameReal: SXB60-69UB
        codeStr: 'https://h5.xxx.com/scan?N=e68a3f4f-b90e-xxxx-84df-9847e85b66ed'
        code: e68a3f4f-b90e-xxxx-84df-9847e85b66ed
        authorizationClientType: '3'
        imei: '865403061390000'
        spuId: '01'
        shopId: '000977'
        items:
          - forceUse: false
            id: '000519'
            functionId: '47'
            extAttrDto:
              items:
                - sequence: 0
                  priceType: 1
                  id: 7be28916-2523-xxxx-8380-4264d1646d38
                  unitCode: 2
                  canMerchantEdit: false
                  isEnabled: true
                  goodsType: 0
                  pulseVolumeFactor: '1'
                  functionType: 2
                  unitAmount: '35'
                  unitPrice: '3.00'
                  compatibleGoodsCategoryCode:
                    - 09
                  isOn: false
                  description: 备注。
                  priceCalculateMode: 2
                  isDefault: false
                  isNewFromSpu: false
                  pulse: '0'
            channelCode: '07'
            price: '3.00'
            extAttr: ''
            name: 标准
            feature: 备注。
            functionName: 标准
            isNewFromSpu: 0
            unit: '35'
            soldState: 1
            pulse: '0'
            skuId: '86'
          - forceUse: false
            id: '000520'
            functionId: '48'
            extAttrDto:
              items:
                - pulse: '0'
                  priceCalculateMode: 2
                  isNewFromSpu: false
                  isOn: false
                  isEnabled: true
                  priceType: 1
                  isDefault: false
                  sequence: 0
                  description: 备注11。
                  unitPrice: '0.01'
                  pulseVolumeFactor: '1'
                  unitCode: 2
                  goodsType: 0
                  canMerchantEdit: false
                  id: 044e9c7f-7bef-xxxx-8955-44eed6a4aa0f
                  functionType: 2
                  compatibleGoodsCategoryCode:
                    - 09
                  unitAmount: '25'
            channelCode: '06'
            price: '0.01'
            extAttr: ''
            name: 快速
            feature: 备注2。
            functionName: 快速
            isNewFromSpu: 0
            unit: '25'
            soldState: 1
            pulse: '0'
            skuId: '87'
          - forceUse: false
            id: '2000912521'
            functionId: '49'
            extAttrDto:
              items:
                - goodsType: 0
                  isOn: false
                  unitPrice: '4.00'
                  isEnabled: true
                  functionType: 2
                  isDefault: false
                  pulseVolumeFactor: '1'
                  unitAmount: '45'
                  priceType: 1
                  id: 6bee6898-c7be-xxxx-8e24-6291dc153dcc
                  priceCalculateMode: 2
                  isNewFromSpu: false
                  description: 备注3。
                  pulse: '0'
                  canMerchantEdit: false
                  unitCode: 2
                  sequence: 0
                  compatibleGoodsCategoryCode:
                    - 09
            channelCode: '05'
            price: '4.00'
            extAttr: ''
            name: 大物
            feature: 描述。
            functionName: 大物
            isNewFromSpu: 0
            unit: '00'
            soldState: 1
            pulse: '0'
            skuId: '88'
          - forceUse: false
            id: '000522'
            functionId: '50'
            extAttrDto:
              items:
                - priceType: 1
                  priceCalculateMode: 2
                  description: 单独进行程序。
                  pulseVolumeFactor: '1'
                  isDefault: false
                  compatibleGoodsCategoryCode:
                    - 09
                  isEnabled: true
                  functionType: 2
                  sequence: 0
                  unitCode: 2
                  isOn: false
                  goodsType: 0
                  pulse: '0'
                  unitPrice: '1.00'
                  id: 87ac6f55-1892-45d2-9b2d-d43add759361
                  isNewFromSpu: false
                  unitAmount: '4'
                  canMerchantEdit: false
            channelCode: '04'
            price: '1.00'
            extAttr: ''
            name: 单脱
            feature: 单独进行程序。
            functionName: 单脱
            isNewFromSpu: 0
            unit: '4'
            soldState: 1
            pulse: '0'
            skuId: '89'
          - forceUse: false
            id: '000523'
            functionId: '75'
            extAttrDto:
              items:
                - pulseVolumeFactor: '1'
                  isOn: false
                  isEnabled: true
                  isNewFromSpu: false
                  priceType: 1
                  description:
                  unitPrice: '0.00'
                  pulse: '0'
                  functionType: 2
                  compatibleGoodsCategoryCode:
                    - 09
                  unitAmount: '2'
                  goodsType: 0
                  priceCalculateMode: 2
                  sequence: 0
                  canMerchantEdit: false
                  isDefault: false
                  unitCode: 2
                  id: dc5bbf67-3a3c-xxxx-a00c-ae904265b509
            channelCode: '03'
            price: '0.00'
            extAttr: ''
            name: 桶自洁
            feature:
            functionName: 桶自洁
            isNewFromSpu: 0
            unit: '2'
            soldState: 1
            pulse: '0'
            skuId: '183'
        positionId: '33553'
        barCode: '865403061394052'
        floorCode: '6'
        name: 新增xxx设备
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success
        - type: is not None
          field: data.id
        - type: equal
          field: data.name
          expected: 新增xxx设备

    - id: goods_delete
      description: 删除xxx设备
      project: merchant
      path: '/goods/delete?platform=Android'
      method: POST
      headers:
        Content-Type: 'application/json'
        Authorization: '{{merchant.token}}'
      data:
        goodsId: '{{device_bind.data.id}}'
        authorizationClientType: 3
      assert:
        - type: equal
          field: code
          expected: 0
        - type: equal
          field: message
          expected: success