name: Auth 认证模块 - 登录登出验证
description: 测试认证模块的登录、登出和 Token 验证功能
steps:
  - id: health_check
    path: /health
    method: GET
    assert:
      - type: status_code
        expected: 200
      - type: field
        field: status
        expected: healthy

  - id: login_success
    path: /api/auth/login
    method: POST
    headers:
      Content-Type: application/json
    data:
      username: admin
      password: password
    assert:
      - type: status_code
        expected: 200
      - type: field
        field: success
        expected: true
      - type: field
        field: data.token
        expected_exists: true

  - id: verify_token
    path: /api/auth/verify
    method: GET
    headers:
      Authorization: "Bearer {{ login_success.data.token }}"
    assert:
      - type: status_code
        expected: 200
      - type: field
        field: success
        expected: true

  - id: logout
    path: /api/auth/logout
    method: POST
    headers:
      Authorization: "Bearer {{ login_success.data.token }}"
    assert:
      - type: status_code
        expected: 200
      - type: field
        field: success
        expected: true

  - id: login_wrong_password
    path: /api/auth/login
    method: POST
    headers:
      Content-Type: application/json
    data:
      username: admin
      password: wrongpassword
    assert:
      - type: status_code
        expected: 401

  - id: verify_without_token
    path: /api/auth/verify
    method: GET
    assert:
      - type: status_code
        expected: 401
